<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-83359NB2SY"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-83359NB2SY');
  </script>
  <title>Consulta de Notas - F√≠sica II</title>
  <style>
@import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;500;700&display=swap');

:root {
  --primary-bg: #f7f4f1;
  --canvas-white: #fdfcfa;
  --watercolor-blue: #a8d8ea;
  --watercolor-rose: #ffb3ba;
  --watercolor-mint: #bae1cc;
  --watercolor-lavender: #dbc4f0;
  --watercolor-peach: #ffdfba;
  --watercolor-sky: #c7e9f1;
  --watercolor-sage: #b8d4c2;
  --soft-gray: #6b7c93;
  --brush-dark: #4a5568;
  --paper-texture: #f9f7f4;
  --error-coral: #ff6b6b;
  --success-emerald: #51cf66;
  --warning-amber: #ffd43b;
  --shadow-soft: rgba(0,0,0,0.08);
  --shadow-gentle: rgba(0,0,0,0.12);
  --shadow-medium: rgba(0,0,0,0.16);
  --font-script: 'Dancing Script', cursive;
  --font-rounded: 'Comfortaa', cursive;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: var(--font-rounded);
  background: var(--primary-bg);
  color: var(--brush-dark);
  min-height: 100vh;
  padding: 24px;
  letter-spacing: 0.2px;
  position: relative;
  overflow-x: hidden;
  line-height: 1.7;
}

/* Watercolor wash background */
body::before {
  content: "";
  pointer-events: none;
  position: fixed;
  left: 0; top: 0; right: 0; bottom: 0;
  z-index: 0;
  opacity: 0.15;
  background: 
    radial-gradient(ellipse at 20% 30%, var(--watercolor-blue) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 20%, var(--watercolor-rose) 0%, transparent 45%),
    radial-gradient(ellipse at 40% 80%, var(--watercolor-mint) 0%, transparent 40%),
    radial-gradient(ellipse at 70% 70%, var(--watercolor-lavender) 0%, transparent 35%),
    radial-gradient(ellipse at 10% 90%, var(--watercolor-peach) 0%, transparent 30%);
  filter: blur(60px);
  animation: watercolorFlow 20s ease-in-out infinite;
}

/* Floating watercolor drops */
body::after {
  content: "";
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  z-index: 0;
  opacity: 0.08;
  background: 
    radial-gradient(circle at 15% 25%, var(--watercolor-sky) 8px, transparent 12px),
    radial-gradient(circle at 85% 15%, var(--watercolor-sage) 6px, transparent 10px),
    radial-gradient(circle at 45% 85%, var(--watercolor-rose) 4px, transparent 8px),
    radial-gradient(circle at 75% 45%, var(--watercolor-mint) 5px, transparent 9px);
  background-size: 150px 150px, 120px 120px, 180px 180px, 140px 140px;
  animation: floatingDrops 25s linear infinite;
  pointer-events: none;
}

@keyframes watercolorFlow {
  0%, 100% { 
    transform: scale(1) rotate(0deg);
    filter: blur(60px) hue-rotate(0deg);
  }
  25% { 
    transform: scale(1.1) rotate(90deg);
    filter: blur(50px) hue-rotate(90deg);
  }
  50% { 
    transform: scale(0.9) rotate(180deg);
    filter: blur(70px) hue-rotate(180deg);
  }
  75% { 
    transform: scale(1.05) rotate(270deg);
    filter: blur(55px) hue-rotate(270deg);
  }
}

@keyframes floatingDrops {
  0% { transform: translateY(100vh) rotate(0deg); }
  100% { transform: translateY(-100px) rotate(360deg); }
}

.container {
  background: var(--canvas-white);
  border: none;
  border-radius: 30px;
  padding: 2.5rem 2rem;
  width: 100%;
  max-width: 480px;
  margin: 0 auto;
  box-shadow: 
    0 15px 40px var(--shadow-gentle),
    inset 0 1px 0 rgba(255,255,255,0.9);
  position: relative;
  z-index: 1;
  background: 
    radial-gradient(circle at 30% 20%, var(--watercolor-sky) 0%, transparent 60%),
    radial-gradient(circle at 70% 80%, var(--watercolor-sage) 0%, transparent 50%),
    var(--canvas-white);
  backdrop-filter: blur(10px);
}

.container::before {
  content: "";
  position: absolute;
  top: -3px;
  left: -3px;
  right: -3px;
  bottom: -3px;
  background: linear-gradient(135deg, 
    var(--watercolor-blue), 
    var(--watercolor-rose), 
    var(--watercolor-mint), 
    var(--watercolor-lavender)
  );
  background-size: 400% 400%;
  border-radius: 33px;
  z-index: -1;
  opacity: 0.6;
  filter: blur(3px);
  animation: watercolorBorder 12s ease-in-out infinite;
}

@keyframes watercolorBorder {
  0%, 100% { background-position: 0% 50%; }
  25% { background-position: 100% 0%; }
  50% { background-position: 100% 100%; }
  75% { background-position: 0% 100%; }
}

h1 {
  font-family: var(--font-script);
  font-size: 2.2rem;
  color: #4a5568;
  text-align: center;
  margin-bottom: 2rem;
  position: relative;
  font-weight: 600;
  letter-spacing: 1px;
  text-shadow: 2px 3px 6px var(--shadow-gentle);
  animation: textFloat 3s ease-in-out infinite;
}

h1::after {
  content: "üé®";
  position: absolute;
  top: -10px;
  right: -35px;
  font-size: 0.6em;
  filter: grayscale(0.2);
  animation: paintbrushFloat 4s ease-in-out infinite;
}

.input-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.6rem;
  margin-bottom: 1.6rem;
  text-align: center;
}

.input-container label {
  font-size: 1.1rem;
  color: var(--soft-gray);
  margin-bottom: 0.5rem;
  font-weight: 500;
  font-family: var(--font-rounded);
  font-style: normal;
}

.input-container input {
  width: 100%;
  max-width: 200px;
  padding: 0.9rem 1rem;
  font-size: 1.1rem;
  border: 2px solid transparent;
  border-radius: 20px;
  background: rgba(255, 255, 255, 0.8);
  color: var(--brush-dark);
  font-family: var(--font-rounded);
  text-align: center;
  outline: none;
  box-shadow: 
    0 4px 15px var(--shadow-soft),
    inset 0 2px 4px rgba(255,255,255,0.5);
  transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  backdrop-filter: blur(8px);
}

.input-container input:focus {
  background: rgba(255, 255, 255, 0.95);
  box-shadow: 
    0 8px 25px var(--shadow-gentle),
    inset 0 2px 4px rgba(255,255,255,0.7),
    0 0 0 4px rgba(168, 216, 234, 0.3);
  transform: translateY(-2px) scale(1.02);
  border: 2px solid var(--watercolor-blue);
}

.input-container button {
  margin-top: 1rem;
  padding: 1rem 2.2rem;
  font-size: 1rem;
  background: linear-gradient(135deg, var(--watercolor-blue), var(--watercolor-lavender));
  color: white;
  border: none;
  border-radius: 30px;
  font-family: var(--font-rounded);
  cursor: pointer;
  font-weight: 600;
  box-shadow: 
    0 8px 20px rgba(168, 216, 234, 0.4),
    inset 0 1px 0 rgba(255,255,255,0.6);
  transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  position: relative;
  overflow: hidden;
  backdrop-filter: blur(10px);
}

.input-container button::before {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  background: radial-gradient(circle, var(--watercolor-mint), var(--watercolor-peach));
  border-radius: 50%;
  transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  transform: translate(-50%, -50%);
  opacity: 0.7;
}

.input-container button:hover {
  background: linear-gradient(135deg, var(--watercolor-lavender), var(--watercolor-rose));
  transform: translateY(-3px) scale(1.05);
  box-shadow: 
    0 12px 30px rgba(219, 196, 240, 0.5),
    inset 0 1px 0 rgba(255,255,255,0.8);
}

.input-container button:hover::before {
  width: 400px;
  height: 400px;
  opacity: 0.3;
}

.input-container button:active {
  transform: translateY(-1px) scale(1.02);
  box-shadow: 
    0 6px 15px rgba(168, 216, 234, 0.3),
    inset 0 1px 0 rgba(255,255,255,0.5);
}

.erro {
  color: white;
  background: linear-gradient(135deg, var(--error-coral), #ff8a80);
  border: none;
  border-radius: 20px;
  padding: 1.2rem 1rem;
  margin: 1.5rem 0;
  font-size: 1rem;
  font-family: var(--font-rounded);
  display: none;
  text-align: center;
  letter-spacing: 0.2px;
  box-shadow: 
    0 8px 20px rgba(255, 107, 107, 0.3),
    inset 0 1px 0 rgba(255,255,255,0.5);
  font-style: normal;
  font-weight: 500;
  backdrop-filter: blur(10px);
}

.notas h2 {
  color: #4a5568;
  font-size: 1.6rem;
  margin-bottom: 1.5rem;
  text-align: center;
  font-family: var(--font-script);
  font-weight: 600;
  position: relative;
  text-shadow: 1px 2px 4px var(--shadow-soft);
}

.notas h2::before {
  content: "üåø";
  position: absolute;
  left: -35px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 1.2rem;
  filter: grayscale(0.3);
  animation: leafSway 3s ease-in-out infinite;
}

@keyframes leafSway {
  0%, 100% { transform: translateY(-50%) rotate(-5deg); }
  50% { transform: translateY(-55%) rotate(5deg); }
}

.notas-container, .notas {
  background: rgba(255, 255, 255, 0.9);
  border: none;
  border-radius: 25px;
  margin: 1.5rem 0;
  padding: 1.8rem 1.2rem;
  box-shadow: 
    0 10px 30px var(--shadow-soft),
    inset 0 1px 0 rgba(255,255,255,0.8);
  font-family: var(--font-rounded);
  position: relative;
  z-index: 1;
  backdrop-filter: blur(15px);
  background: 
    radial-gradient(circle at 80% 20%, var(--watercolor-peach) 0%, transparent 40%),
    radial-gradient(circle at 20% 80%, var(--watercolor-sky) 0%, transparent 35%),
    rgba(255, 255, 255, 0.85);
}

.notas-container::before {
  content: "";
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  background: linear-gradient(135deg, 
    var(--watercolor-mint), 
    var(--watercolor-lavender), 
    var(--watercolor-rose)
  );
  background-size: 300% 300%;
  border-radius: 27px;
  z-index: -1;
  opacity: 0.4;
  filter: blur(2px);
  animation: containerBorder 10s ease-in-out infinite;
}

@keyframes containerBorder {
  0%, 100% { background-position: 0% 50%; }
  33% { background-position: 100% 0%; }
  66% { background-position: 100% 100%; }
}

@keyframes textFloat {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-3px); }
}

@keyframes paintbrushFloat {
  0%, 100% { transform: scale(1) rotate(-10deg); opacity: 0.8; }
  50% { transform: scale(1.1) rotate(10deg); opacity: 1; }
}

.notas-container h3 {
  color: #4a5568;
  margin-bottom: 1rem;
  font-size: 1.3rem;
  text-align: center;
  font-family: var(--font-script);
  font-weight: 600;
  position: relative;
  text-shadow: 1px 2px 4px var(--shadow-soft);
}

.notas-container h3::after {
  content: "";
  position: absolute;
  bottom: -5px;
  left: 50%;
  transform: translateX(-50%);
  width: 40px;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--watercolor-blue), transparent);
  border-radius: 1px;
  opacity: 0.6;
}



table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  background: transparent;
  font-size: 1rem;
  border-radius: 20px;
  overflow: hidden;
  box-shadow: 0 8px 25px var(--shadow-soft);
}

th, td {
  padding: 1rem 0.8rem;
  text-align: left;
  border: none;
  font-family: var(--font-rounded);
  color: var(--brush-dark);
  transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  position: relative;
}

th {
  background: linear-gradient(135deg, var(--watercolor-lavender), var(--watercolor-blue));
  color: white;
  font-weight: 600;
  letter-spacing: 0.5px;
  text-shadow: 0 2px 4px var(--shadow-soft);
  backdrop-filter: blur(10px);
}

tr:last-child td {
  border-bottom: none;
}

tr:nth-child(even) td {
  background: rgba(186, 225, 204, 0.2);
}

tr:nth-child(odd) td {
  background: rgba(199, 233, 241, 0.15);
}

tr:hover td {
  background: linear-gradient(135deg, 
    rgba(168, 216, 234, 0.3), 
    rgba(255, 179, 186, 0.3)
  );
  transform: scale(1.01);
  box-shadow: 0 4px 15px var(--shadow-gentle);
}

td strong {
  color: #2d3748;
  font-weight: 700;
  text-shadow: 1px 1px 2px var(--shadow-soft);
}



.notas-container.final {
  margin-top: 2rem;
  text-align: center;
  padding: 2.5rem 1.8rem;
  box-shadow: 
    0 15px 40px var(--shadow-gentle),
    inset 0 2px 0 rgba(255,255,255,0.9);
  border-radius: 30px;
  backdrop-filter: blur(20px);
  position: relative;
  overflow: hidden;
}

.notas-container.final::before {
  content: "";
  position: absolute;
  top: -3px;
  left: -3px;
  right: -3px;
  bottom: -3px;
  border-radius: 33px;
  z-index: -1;
  opacity: 0.8;
  filter: blur(4px);
}

.notas-container.final.aprovado {
  background: 
    radial-gradient(circle at 30% 30%, var(--watercolor-mint) 0%, transparent 50%),
    radial-gradient(circle at 70% 70%, var(--success-emerald) 0%, transparent 40%),
    rgba(255, 255, 255, 0.9);
}

.notas-container.final.aprovado::before {
  background: linear-gradient(135deg, 
    var(--watercolor-mint), 
    var(--success-emerald),
    var(--watercolor-sage)
  );
  background-size: 300% 300%;
  animation: successBorder 8s ease-in-out infinite;
}

.notas-container.final.recuperacao {
  background: 
    radial-gradient(circle at 30% 30%, var(--watercolor-peach) 0%, transparent 50%),
    radial-gradient(circle at 70% 70%, var(--warning-amber) 0%, transparent 40%),
    rgba(255, 255, 255, 0.9);
}

.notas-container.final.recuperacao::before {
  background: linear-gradient(135deg, 
    var(--watercolor-peach), 
    var(--warning-amber),
    #ffd93d
  );
  background-size: 300% 300%;
  animation: warningBorder 8s ease-in-out infinite;
}

.notas-container.final.reprovado {
  background: 
    radial-gradient(circle at 30% 30%, var(--watercolor-rose) 0%, transparent 50%),
    radial-gradient(circle at 70% 70%, var(--error-coral) 0%, transparent 40%),
    rgba(255, 255, 255, 0.9);
}

.notas-container.final.reprovado::before {
  background: linear-gradient(135deg, 
    var(--watercolor-rose), 
    var(--error-coral),
    #ff8a80
  );
  background-size: 300% 300%;
  animation: errorBorder 8s ease-in-out infinite;
}

@keyframes successBorder {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

@keyframes warningBorder {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

@keyframes errorBorder {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.notas-container.final h3 {
  font-size: 1.4rem;
  margin-bottom: 1.2rem;
  color: #4a5568;
  font-family: var(--font-script);
  font-weight: 600;
  text-shadow: 1px 2px 4px var(--shadow-soft);
}

.notas-container.final .valor {
  font-size: 2.2rem;
  font-weight: 700;
  margin: 1rem 0;
  font-family: var(--font-script);
  text-shadow: 2px 3px 8px rgba(0,0,0,0.3);
}

.notas-container.final.reprovado .valor {
  color: #d32f2f;
  text-shadow: 2px 3px 8px rgba(211, 47, 47, 0.4);
}
.notas-container.final.recuperacao .valor {
  color: #f57c00;
  text-shadow: 2px 3px 8px rgba(245, 124, 0, 0.4);
}
.notas-container.final.aprovado .valor {
  color: #388e3c;
  text-shadow: 2px 3px 8px rgba(56, 142, 60, 0.4);
}





.presenca-info {
  background: 
    radial-gradient(circle at 30% 30%, var(--watercolor-sky) 0%, transparent 50%),
    radial-gradient(circle at 70% 70%, var(--watercolor-mint) 0%, transparent 40%),
    rgba(255, 255, 255, 0.9);
  border: none;
  border-radius: 25px;
  padding: 2rem;
  margin: 2rem 0 1rem 0;
  text-align: center;
  font-family: var(--font-rounded);
  transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  color: var(--brush-dark);
  box-shadow: 
    0 12px 30px var(--shadow-soft),
    inset 0 2px 0 rgba(255,255,255,0.8);
  backdrop-filter: blur(15px);
  position: relative;
  overflow: hidden;
}

.presenca-info::before {
  content: "";
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  background: linear-gradient(135deg, 
    var(--watercolor-mint), 
    var(--watercolor-sky), 
    var(--watercolor-sage)
  );
  background-size: 300% 300%;
  border-radius: 27px;
  z-index: -1;
  opacity: 0.5;
  filter: blur(3px);
  animation: presenceBorder 10s ease-in-out infinite;
}

.presenca-info .valor {
  font-size: 1.8rem;
  font-weight: 700;
  margin: 0.8rem 0;
  font-family: var(--font-script);
  color: #388e3c;
  text-shadow: 2px 2px 4px rgba(56, 142, 60, 0.3);
}

.presenca-info.irregular {
  background: 
    radial-gradient(circle at 30% 30%, var(--watercolor-rose) 0%, transparent 50%),
    radial-gradient(circle at 70% 70%, var(--error-coral) 0%, transparent 40%),
    rgba(255, 255, 255, 0.9);
}

.presenca-info.irregular::before {
  background: linear-gradient(135deg, 
    var(--watercolor-rose), 
    var(--error-coral),
    #ff8a80
  );
  animation: irregularBorder 8s ease-in-out infinite;
}

.presenca-info.irregular .valor {
  color: #d32f2f;
  text-shadow: 2px 2px 4px rgba(211, 47, 47, 0.3);
}

.presenca-info .status {
  font-size: 1rem;
  font-weight: 600;
  margin-top: 0.8rem;
  font-style: normal;
  color: #d32f2f;
  text-shadow: 1px 1px 2px rgba(211, 47, 47, 0.3);
}

@keyframes presenceBorder {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

@keyframes irregularBorder {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

@media (max-width: 520px) {
  body {
    padding: 12px;
  }
  .container {
    padding: 2rem 1.2rem;
    max-width: 95vw;
  }
  h1 {
    font-size: 1.8rem;
    margin-bottom: 1.5rem;
    letter-spacing: 0.5px;
  }
  h1::after {
    right: -25px;
    font-size: 0.5em;
  }
  .input-container input {
    font-size: 1rem;
    padding: 0.8rem 1rem;
    max-width: 180px;
  }
  .input-container button {
    font-size: 0.9rem;
    padding: 0.9rem 1.8rem;
  }
  .notas h2::before {
    left: -25px;
    font-size: 1rem;
  }
  th, td {
    padding: 0.8rem 0.5rem;
    font-size: 0.9rem;
  }
  .notas-container, .notas-container.final {
    padding: 1.5rem 1rem;
    margin: 1.2rem 0;
  }
  .notas-container h3 {
    font-size: 1.1rem;
  }
  .notas-container.final {
    padding: 2rem 1.2rem;
  }
  .notas-container.final .valor {
    font-size: 1.8rem;
  }
  .presenca-info {
    padding: 1.5rem;
  }
  .presenca-info .valor {
    font-size: 1.5rem;
  }
}


  </style>
</head>
<body>
  <div class="container">
    <h1>F√≠sica 2 - 1s 2025</h1>
    <div class="input-container">
      <label for="grrInput">Digite seu GRR:</label>
      <input type="text" id="grrInput" placeholder="Ex: 20201234" maxlength="8" pattern="[0-9]*" inputmode="numeric">
      <button onclick="buscarNotas()">Consultar Notas</button>
    </div>
    <div id="erro" class="erro" style="display: none;"></div>
    <div id="resultado" style="display: none;"></div>
  </div>

<script>
const urlsAPI = [
  "https://script.google.com/macros/s/AKfycbxPityOQM9KLlTlEWZfvPBk6BOj6hc-JI-wgAWOfm35F9ZJIM51Z1s0htVyedfviFB6kw/exec",
  "https://script.google.com/macros/s/AKfycbzjeofh934wP2Jds87Blhnu7i5aJteI2rCjIjjrfVyBy8zGYgb4-YJXSLbefVDjmsDkVQ/exec"
];

let avaliacoes = [];
let alunos = [];

// Carregar dados de todas as APIs
Promise.all(urlsAPI.map(url => fetch(url).then(res => res.json())))
  .then(dadosArray => {
    // Combinar dados de todas as APIs
    dadosArray.forEach(dados => {
      // Adicionar avalia√ß√µes √∫nicas
      dados.avaliacoes.forEach(av => {
        if (!avaliacoes.includes(av)) {
          avaliacoes.push(av);
        }
      });
      
      // Combinar alunos, atualizando notas existentes
      dados.alunos.forEach(novoAluno => {
        const alunoExistente = alunos.find(a => a.grr === novoAluno.grr);
        if (alunoExistente) {
          // Atualizar notas existentes e adicionar novas
          novoAluno.notas.forEach((nota, i) => {
            if (nota !== '-' && nota !== '') {
              alunoExistente.notas[i] = nota;
            }
          });
          // Atualizar presen√ßa se dispon√≠vel
          if (novoAluno.presenca !== undefined) {
            alunoExistente.presenca = novoAluno.presenca;
          }
        } else {
          // Adicionar novo aluno
          alunos.push(novoAluno);
        }
      });
    });
  })
  .catch(erro => {
    console.error('Erro ao carregar dados:', erro);
    mostrarErro('Erro ao carregar dados. Por favor, tente novamente mais tarde.');
  });

// Permitir apenas n√∫meros no input
document.getElementById('grrInput').addEventListener('input', function(e) {
  this.value = this.value.replace(/[^0-9]/g, '');
});

// Buscar notas ao pressionar Enter
document.getElementById('grrInput').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    buscarNotas();
  }
});

function mostrarErro(mensagem) {
  const erro = document.getElementById('erro');
  erro.textContent = mensagem;
  erro.style.display = 'block';
  document.getElementById('resultado').style.display = 'none';
}

function formatarNota(nota) {
  if (nota === null || nota === undefined || nota === '-' || nota === '') return '-';
  return Number(nota).toFixed(1);
}

function calcularStatusPresenca(presenca) {
  return presenca < 75 ? 'Reprovado por falta' : '';
}

function calcularMedia(notas, indices) {
  const notasValidas = indices
    .map(i => parseFloat(notas[i]))
    .filter(nota => !isNaN(nota));
  
  if (notasValidas.length === 0) return '-';
  return (notasValidas.reduce((a, b) => a + b, 0) / notasValidas.length).toFixed(1);
}

function getClasseNotaFinal(nota) {
  if (nota === '-') return '';
  const valor = parseFloat(nota);
  if (isNaN(valor)) return '';
  if (valor < 4) return 'reprovado';
  if (valor < 7) return 'recuperacao';
  return 'aprovado';
}

function buscarNotas() {
  const grrNumero = document.getElementById('grrInput').value.trim();
  const resultado = document.getElementById('resultado');
  const erro = document.getElementById('erro');
  
  // Limpar resultados anteriores
  resultado.style.display = 'none';
  erro.style.display = 'none';

  // Validar entrada
  if (grrNumero.length !== 8) {
    mostrarErro('Digite os 8 n√∫meros do GRR.');
    return;
  }

  const grrCompleto = 'GRR' + grrNumero;
  const aluno = alunos.find(a => a.grr === grrCompleto);
  
  if (!aluno) {
    mostrarErro('GRR n√£o encontrado. Verifique o n√∫mero e tente novamente.');
    return;
  }

  try {
    // Exibir notas
    let html = `<h2>Notas do GRR ${grrNumero}</h2>`;

    // Container de Grava√ß√µes
    const indicesG = avaliacoes
      .map((av, i) => av.startsWith('G') ? i : -1)
      .filter(i => i !== -1);
    
    const indiceMediaG = avaliacoes.indexOf("M√©dia G");
const mediaG = formatarNota(aluno.notas[indiceMediaG]);
    
    html += `
      <div class="notas-container">
        <h3>Grava√ß√µes</h3>
        <table>
          <tr>
            <th>Avalia√ß√£o</th>
            <th>Nota</th>
          </tr>
    `;

    indicesG.forEach(i => {
      html += `
        <tr>
          <td>${avaliacoes[i]}</td>
          <td>${formatarNota(aluno.notas[i])}</td>
        </tr>
      `;
    });

    html += `
          <tr>
            <td><strong>M√©dia G</strong></td>
            <td><strong>${mediaG}</strong></td>
          </tr>
        </table>
      </div>
    `;

    // Container de Provas
    const indicesP = avaliacoes
      .map((av, i) => av.startsWith('P') ? i : -1)
      .filter(i => i !== -1);
    
const indiceMediaP = avaliacoes.indexOf("M√©dia P");
const mediaP = formatarNota(aluno.notas[indiceMediaP]);
    
    html += `
      <div class="notas-container">
        <h3>Provas</h3>
        <table>
          <tr>
            <th>Avalia√ß√£o</th>
            <th>Nota</th>
          </tr>
    `;

    indicesP.forEach(i => {
      html += `
        <tr>
          <td>${avaliacoes[i]}</td>
          <td>${formatarNota(aluno.notas[i])}</td>
        </tr>
      `;
    });

    html += `
          <tr>
            <td><strong>M√©dia P</strong></td>
            <td><strong>${mediaP}</strong></td>
          </tr>
        </table>
      </div>
    `;

    // Container da Nota Final
    const notaFinal = formatarNota(aluno.notas[aluno.notas.length - 1]);
    const classeNotaFinal = getClasseNotaFinal(notaFinal);
    html += `
      <div class="notas-container final ${classeNotaFinal}">
        <h3>Nota Final</h3>
        <div class="valor">${notaFinal}</div>
      </div>
    `;

    // Adicionar informa√ß√£o de presen√ßa no final
    if (aluno.presenca !== undefined) {
      const statusPresenca = calcularStatusPresenca(aluno.presenca);
      const classeStatus = aluno.presenca < 75 ? 'irregular' : '';
      
      html += `
        <div class="presenca-info ${classeStatus}">
          <div>Frequ√™ncia</div>
          <div class="valor">${aluno.presenca.toFixed(1)}%</div>
          ${statusPresenca ? `<div class="status">${statusPresenca}</div>` : ''}
        </div>
      `;
    }

    resultado.innerHTML = html;
    resultado.style.display = 'block';
  } catch (error) {
    console.error('Erro ao processar notas:', error);
    mostrarErro('Ocorreu um erro ao processar as notas. Por favor, tente novamente.');
  }
}
</script>

</body>
</html>

